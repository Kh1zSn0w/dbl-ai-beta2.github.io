<!doctype html>
<meta charset="utf-8">
<title>Cronix Remote</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
  body{font-family:system-ui;margin:24px;background:#0b0b0b;color:#eee}
  .card{background:#151515;border:1px solid #222;border-radius:14px;padding:18px;margin-bottom:16px;max-width:520px}
  button{background:#222;border:1px solid #444;color:#eee;padding:10px 14px;border-radius:10px;cursor:pointer}
  button:hover{border-color:#777}
  .badge{padding:6px 10px;border-radius:999px;font-weight:600;margin-left:6px}
  .ok{background:#14351a;color:#65e077}.bad{background:#3a1414;color:#ff7777}
</style>

<div class="card">
  <h2 style="margin:0 0 10px">Cronix Remote</h2>
  <div>cronix: <span id="c" class="badge bad">?</span> ngrok: <span id="n" class="badge bad">?</span></div>
  <div style="margin-top:12px">
    <button onclick="post('/start')">Start Cronix</button>
    <button onclick="post('/stop')">Stop Cronix</button>
  </div>
  <div style="margin-top:12px">
    <button onclick="post('/ngrok/start')">Start ngrok</button>
    <button onclick="post('/ngrok/stop')">Stop ngrok</button>
  </div>
  <div id="msg" style="margin-top:12px;opacity:.8"></div>
</div>

<script>
  const API = "https://7f007fe8f767.ngrok.app";         // control URL
  const SECRET = "kh1z-ctrl-1_FQ9k6rTA2z3iG4pN7sY0w";    // same as on server

  async function post(path){
    try{
      const r = await fetch(API+path,{method:'POST',headers:{'X-Panel-Secret':SECRET}});
      document.getElementById('msg').textContent = await r.text();
      refresh();
    }catch(e){ document.getElementById('msg').textContent = 'error: '+e; }
  }
  async function refresh(){
    try{
      const r = await fetch(API+'/status',{headers:{'X-Panel-Secret':SECRET}});
      const j = await r.json();
      badge('c', j.cronix); badge('n', j.ngrok);
    }catch(e){ document.getElementById('msg').textContent = 'status error'; }
  }
  function badge(id, up){
    const el = document.getElementById(id);
    el.textContent = up ? 'ONLINE' : 'OFFLINE';
    el.className = 'badge ' + (up ? 'ok' : 'bad');
  }
  refresh(); setInterval(refresh, 4000);
</script>
